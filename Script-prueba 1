#SCRIPT PARA ACTAULIZACION AUTOMATICA, AL MISMO MAIL DE ROOT

#############################################################################################################
#!/bin/bash

# Actualizar la lista de paquetes y obtener la lista de paquetes actualizables
updates=$(apt update > /dev/null && apt list --upgradable 2>/dev/null | grep -v -E "(Listing|apt-utils|grep)")

# Comprobar si hay actualizaciones disponibles
if [ -z "$updates" ]; then
    echo "No hay actualizaciones disponibles."
else
    echo "Hay actualizaciones pendientes de los paquetes:"
    echo "$updates"
    
    # Realizar actualización automática
    apt upgrade -y
    
    # Enviar correo electrónico a root después de la actualización
    mail -s "Informe de actualización de APT" root <<EOF
Las siguientes actualizaciones de APT se han realizado correctamente:

$updates
EOF
fi

# Enviar correo electrónico a root antes de la actualización
mail -s "Informe de actualización de APT" root <<EOF
Las siguientes actualizaciones de APT están pendientes:

$updates
EOF

